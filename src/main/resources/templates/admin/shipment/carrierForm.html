<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>배송업체 추가/수정</title>
  <script>
    // 폼 유효성 검사
    function validateForm() {
      const contactNumber = document.getElementById("contactNumber").value;
      const contactEmail = document.getElementById("contactEmail").value;
      const websiteUrl = document.getElementById("websiteUrl").value;

      const contactNumberPattern = /^\d{3}-\d{4}-\d{4}$/;
      if (!contactNumberPattern.test(contactNumber)) {
        alert("올바른 연락처를 입력하세요.");
        return false;
      }

      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;  // 간단한 이메일 패턴
      if (contactEmail && !emailPattern.test(contactEmail)) {
        alert("올바른 이메일 주소를 입력하세요.");
        return false;
      }

      const urlPattern = /^(http|https):\/\/[^ "]+$/;  // URL 패턴
      if (websiteUrl && !urlPattern.test(websiteUrl)) {
        alert("올바른 웹사이트 URL을 입력하세요.");
        return false;
      }

      return true;  // 모든 검사를 통과하면 폼이 제출됨
    }
  </script>
</head>
<body>
<h1 th:text="${carrier?.carrierId == null ? '배송업체 추가' : '배송업체 수정'}"></h1>

<!-- 폼 전송 경로 결정: ID가 있으면 수정, 없으면 추가 -->
<form th:action="${carrier?.carrierId == null ? '/carriers' : '/carriers/' + carrier.carrierId + '/edit'}"
      th:object="${carrier}" method="post" onsubmit="return validateForm()">

  <!-- 이름 필드 -->
  <div>
    <label for="name">이름:</label>
    <input type="text" id="name" th:field="*{name}" required>
  </div>

  <!-- 연락처 필드 -->
  <div>
    <label for="contactNumber">연락처:</label>
    <input type="text" id="contactNumber" th:field="*{contactNumber}" pattern="\d{3}-\d{4}-\d{4}" title="올바른 연락처를 입력하세요. 예: 010-1234-5678" required>
  </div>

  <!-- 이메일 필드 -->
  <div>
    <label for="contactEmail">이메일:</label>
    <input type="email" id="contactEmail" th:field="*{contactEmail}" pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="올바른 이메일 주소를 입력하세요">
  </div>

  <!-- 웹사이트 필드 -->
  <div>
    <label for="websiteUrl">웹사이트:</label>
    <input type="url" id="websiteUrl" th:field="*{websiteUrl}" pattern="https?://.+" title="올바른 웹사이트 URL을 입력하세요">
  </div>

  <!-- 제출 버튼 -->
  <button type="submit" th:text="${#strings.isEmpty(carrier.carrierId) ? '추가' : '수정'}"></button>

  </form>

<!-- 취소 버튼 -->
<a href="/carriers">목록으로 돌아가기</a>
</body>
</html>
