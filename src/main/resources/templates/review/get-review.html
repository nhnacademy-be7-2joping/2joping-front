<!DOCTYPE html>
<html lang="ko" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/mainpage-layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>리뷰 상세 정보</title>
    <link rel="stylesheet" th:href="@{/css/review-detail-style.css}">
    <style>
        /* 별점 스타일 */
        .stars {
            display: flex;
            justify-content: flex-start;
        }

        .star {
            font-size: 1.8rem;
            color: lightgray;
            margin-right: 0.2rem;
        }

        .star.selected {
            color: gold;
        }

        /* 리뷰 이미지 스타일 */
        .review-image {
            max-width: 300px; /* 이미지 최대 너비 */
            height: auto; /* 비율 유지 */
            display: block;
            border: 1px solid #ccc; /* 테두리 */
            padding: 5px; /* 여백 */
            margin-top: 10px;
        }

        /* 컨테이너 스타일 */
        .review-detail-container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* 버튼 스타일 */
        .back-button {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 15px;
            color: #fff;
            background-color: #007bff;
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
        }

        .back-button:hover {
            background-color: #0056b3;
        }
    </style>
    <script>
        /**
         * 별점 렌더링 함수
         * @param rating 평점 값
         */
        function renderStars(rating) {
            const stars = document.querySelectorAll('.stars .star');
            stars.forEach((star, index) => {
                star.classList.toggle('selected', index < rating); // 선택된 별만 노란색으로 변경
            });
        }

        // 페이지 로드 시 별점 렌더링
        document.addEventListener('DOMContentLoaded', function () {
            const ratingElement = document.getElementById('rating-stars');
            const ratingValue = parseInt(ratingElement.getAttribute('data-rating'), 10) || 0; // 평점값 가져오기
            renderStars(ratingValue);
        });
    </script>
</head>
<body>
<div layout:fragment="content" class="review-detail-container">
    <h1>리뷰 상세 정보</h1>

    <!-- 리뷰 ID, 회원 ID, 도서 ID -->
    <div>
        <p><strong>리뷰 ID:</strong> <span th:text="${review.reviewId}">리뷰 ID 없음</span></p>
        <p><strong>회원 ID:</strong> <span th:text="${review.customerId}">회원 ID 없음</span></p>
        <p><strong>도서 ID:</strong> <span th:text="${review.bookId}">도서 ID 없음</span></p>
    </div>

    <!-- 평점 -->
    <div>
        <p><span class="rating-label"><strong>평점:</strong></span></p>
        <div class="stars" id="rating-stars" th:attr="data-rating=${review.ratingValue}">
            <span class="star">★</span>
            <span class="star">★</span>
            <span class="star">★</span>
            <span class="star">★</span>
            <span class="star">★</span>
        </div>
    </div>

    <!-- 리뷰 제목, 내용 -->
    <div>
        <p><strong>제목:</strong> <span th:text="${review.title}">제목 없음</span></p>
        <p><strong>내용:</strong> <span th:text="${review.text}">내용 없음</span></p>
    </div>

    <!-- 리뷰 이미지 -->
    <div>
        <p><strong>이미지:</strong></p>
        <img th:src="${review.reviewImage != null ? review.reviewImage : '/images/default-review-image.jpg'}"
             alt="리뷰 이미지" class="review-image">
    </div>

    <!-- 작성일, 수정일 -->
    <div>
        <p><strong>작성일:</strong> <span th:text="${review.createdAt}">작성일 없음</span></p>
        <p><strong>수정일:</strong> <span th:text="${review.updatedAt}">수정일 없음</span></p>
    </div>

    <!-- 돌아가기 버튼 -->
    <a th:href="@{/books/{bookId}(bookId=${review.bookId})}" class="back-button">이전으로 돌아가기</a>
</div>
</body>
</html>
